---
title: エクセルファイルの読み込み(L54)
page-layout: full
title-block-banner: true
comments: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE, include = TRUE)
```

csvファイル等のテキストファイルでのデータの配布とならんでよく見かけるのが、エクセルファイルでのファイルの配布ですなんなら、ビジネス領域ではエクセルファイルの方がよく見かけるファイル形式かもしれません。

readrで簡単にエクセルファイルを読み込めたらよいのですが、残念ながら、readrにはエクセル形式を読み込む機能はありません。

その代わり、readxlパッケージというものを利用してデータを簡単に取り込みことができます。まずは、

```{r}
install.packages("readxl")
```

でパッケージをインストールしましょう。インストールが終われば、

```{r}
library(readxl)

read_excel("import_excel.xlsx")
```

で読み込むことができました。

これだけでもよいのですが、他にも、いくつか、エクセルファイルを読み込むときに知っておいた方がよい事項について簡単に解説させていただきます。

まずは、エクセルファイル、1個のファイルにシートの形で複数のデータが含まれていることがありますよね?その場合、どの名前のシートがあるかを確認するために

```{r}
readxl::excel_sheets("import_excel.xlsx")
```

この関数でシート名を確認できます。ここで確認したシート名を利用して、

```{r}
read_excel("import_excel.xlsx",sheet="テスト2")
```

で読み込めます。

ただ、テスト2シート、データが左上から始まっていない上に余分な文章が含まれているためちゃんと読み込めません。

このような場合は、

```{r}
read_excel("import_excel.xlsx",sheet="テスト2",range="F7:L11")
```

range Argumentを指定してあげることで読み込めます。
また、このRangeにシートの指定も可能なので、

```{r}
read_excel("import_excel.xlsx",range="テスト2!F7:L11")
```

こんな書き方でも取り込めます。

以上、ファイルの場所を指定して、後は、sheetやrangeで読み取り範囲を指定すれば、エクセルファイル、比較的に簡単に読み込めたはずです。

次は、他の統計ソフトのデータの読み込み方法について解説を続けます。
---
title: データの作成
page-layout: full
title-block-banner: true
comments: false
---

それではRで集計を行っていきましょう。スライドでお示しした通り、集計とは、ベクトル（数字や文字列、因子などの要素）の特徴を何かしらの代表的な値にまとめることになります
 
Rでこれを実施するためには、やりたい集計に応じた関数を知っておく必要がありますとりあえず、
 

```{r}
library(tidyverse)

dat <- tibble(
  num = c(1  ,2  ,3  ,4  ,5  ,6  ,7  ,8  ,9  ,10),
  fac2 =c("a","b","a","b","a","b","a","b","a","b") %>% as.factor(),
  fac3 =c("A","B","C","A","B","C","A","B","C","A") %>% as.factor()
)

dat
```

こんな感じのtibbleを集計していくことを考えましょう

* numは数字ベクトル、
* fac2はレベルが二つの因子ベクトル、
* fac3はレベルが3つの因子ベクトル

となります。


ちなみに、繰り返しを簡単にできるrepという関数を利利すると

```{r}
rep( c("a","b"), 4)
```

という感じで、最初に与えた要素、次に与えた数字の数だけくりかえしたベクトルを返してくれるので、上のdatは、

```{r}
dat <- tibble(
  num = 1:10,
  fac2 = rep(c("a","b"), 5),
  fac3 = rep(c("A","B","C"), 4)[1:10]
)

dat
```

とも書けます。fac3で[1:10]としているのは

```{r, error=TRUE}
tibble(num  = 1:3, 
       test = c("a","b","c","a","b","c"))
```

このように、tibble内では、すべて同じ長さの要素を与えないとエラーが生じるので、

```{r}
tibble(num  = 1:3, 
       test = c("a","b","c","a","b","c")[1:3] )
```

ようそをnumの数と同じだけにするためのものです。repを使うと与えた要素の長さの倍数の長さにしかならないので、この[]は地味に大切です。

100行で同様のパターンのものを作りたければ

```{r}
dat <- tibble(
  num = 1:100,
  fac2 = rep(c("a","b"), 50),
  fac3 = rep(c("A","B","C"), 100)[1:100] 
)

dat
```

(本当はfac3繰り返し回数は34が最適ですが、計算するのが面倒なので全部100としています)

ですし、X行のものを作る関数にしたければ、

```{r}
genXrow <- function(X){
  tibble(
    num = 1:X,
    fac2 = rep(c("a","b")    , X)[1:X],
    fac3 = rep(c("A","B","C"), X)[1:X]
  )
}

dat <- genXrow(11)
dat

genXrow(10000)
```

となります

余談でした。

こういう風に、データを自分で作れるようになると色々な関数や統計的なことを勉強する際に自分で仕組みがわかっているデータを作成できるのでおすすめです。

それでは、次に、集計用の関数の解説をおこなっていきましょう
---
title: filter()の実践
page-layout: full
title-block-banner: true
comments: false
---

それでは、filerを実践していきましょう。まずはtibbleを作りましょう
 
```{r}
library(tidyverse)
dat <- tibble(a = c(1:50), b = sample(50:1))

dat
```

まず、a列が15であるものをとりだします

```{r}
dat %>% filter(a == 15)
```

a列が15あるいはb列が30以上の行をとりだせますか？

```{r}
dat %>% filter(a == 15 | b >= 30)
```

ロジカル型の練習問題ででてきた書き方を応用すれば、

a列が2の倍数となる行は

```{r}
dat %>% filter(a %% 2 == 0)
```

b列が2の倍数となる行は

```{r}
dat %>% filter(b %% 2 == 0)
```

こんな感じで列をTRUE、FALSEのベクトルを利用して抽出することができます。

また、もちろん、文字列型の列に対しても同じように操作ができて、

```{r}
dat <- tibble(
  num = 1:10,
  chr = c("a","a","b","b","c","c","c","a","b","c")
)

dat

dat %>% filter(chr == "a")
```

とすることによって文字列を条件づけて行をとりだすことができます。

ここで、aとcを取り出したい場合は、

```{r}
dat %>% filter(chr == c("a","c"))
```

とすると実は誤っているので注意が必要です。なぜなら、
```
dat$chr   : "a","a","b","b","c","c","c","a","b","c"
c("a","c"): "a","c","a","c","a","c","a","c","a","c", 
             T   F   F   F   F   T   F   F   F   T
```

こんな感じで繰り返されたTRUE,FALSEが返ってくると解されるからです。

ここで、複数条件で絞り込む場合は、すこし特殊な、

```{r}
dat %>% filter(chr %in% c("a","c"))
```

%in% 記号というものを利用します。この記号を利用することで、

```
dat$chr   : "a","a","b","b","c","c","c","a","b","c"

c("a","c"): "a","a","a","a","a","a","a","a","a","a"
　　　　　　"c","c","c","c","c","c","c","c","c","c"
             T   T   F   F   T   T   F   T   F   T
```

両方のどちらかと一致する形になります。もちろん、｜演算子を利用して、

```{r}
dat %>% filter(chr == "a" | chr == "c")
```

と書いても同じ結果になりますが、 %in% の書き方を知っていると楽なので、ここで紹介しました。

それでは、filter関数の練習問題に進んでいきましょう。
